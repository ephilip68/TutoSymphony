{% set body_class = 'home-page' %}
{% extends 'base.html.twig' %}

{% block title %}Accueil - MonSite Recettes{% endblock %}

{% block stylesheets %}
  {{ parent() }}
   {{ encore_entry_link_tags('app') }}
  
{% endblock %}

{% block body %}
  <!-- Hero section -->
  <section class="hero">
    <div class="hero-content">
      <h1>Savourez vos envies</h1>
      <p>Découvrez des recettes gourmandes et inspirantes à chaque visite</p>
      <a href="{{ path('recipe_list') }}" class="btn btn-primary btn-hero">Voir les recettes</a>
    </div>
  </section>

  <!-- Carrousel de recettes -->
<section id="carouselRecettes" class="fade-in-section" style="width: 100%; padding: 1rem 0 3rem 0;">
  <div class="container py-4">
    <h2 class="text-center mb-4 fw-bold" style="font-family: 'Playfair Display', serif; font-size: 2.3rem;">
      Nos Dernières Recettes
    </h2>
    <h3 class="text-center mb-5" style="color: #4a7c59;">
      Des créations fraîchement sorties de nos cuisines pour éveiller vos papilles 
    </h3>

    {% if recipes is not empty %}
      <div id="recipeCarousel" class="carousel slide" data-bs-ride="carousel" >
        <div class="carousel-inner">
          {% for recipe in recipes %}
            {% set imagePath = vich_uploader_asset(recipe, 'thumbnailFile') %}
            <div class="carousel-item {% if loop.first %}active{% endif %}">
              <div class="card recipe-card mx-auto">
                {% if imagePath %}
                  <img src="{{ imagePath | imagine_filter('thumb_700x400') }}" alt="Image de {{ recipe.title }}">
                {% else %}
                  <img src="{{ asset('images/default-recipe.webp') | imagine_filter('thumb_700x400') }}" alt="Image par défaut">
                {% endif %}

                <div class="card-body">
                  <h5>{{ recipe.title }}</h5>
                  <p>{{ recipe.content|slice(0, 120) ~ '...' }}</p>
                  <a href="{{ path('recipe_show', { slug: recipe.slug }) }} ">
                    Voir la recette >
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#recipeCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Précédent</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#recipeCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Suivant</span>
        </button>
      </div>
    {% else %}
      <p class="text-center" style="color: #4a7c4a;">Aucune recette disponible pour le moment.</p>
    {% endif %}
  </div>
</section>

<!-- Section catégories -->
<section class="fade-in-section" style="width: 100%; margin-top: 0; padding: 2rem 0; background-color: #4a7c59;" >
  <div class="container my-4">
    <h2 class="text-center mb-4 fw-bold" style="font-family: 'Playfair Display', serif; font-size: 2.3rem; color: #fff;">
      Nos Catégories
    </h2>
    <h3 class="text-center mb-5" style="color: #e2f2e2; ">
      Trouvez l’inspiration selon vos envies et vos goûts 
    </h3>
    <div class="row justify-content-center align-items-stretch g-4">
      {% for category in categories %}
        <div class="col-md-4 d-flex justify-content-center">
          <div class="category-card">
            {% set imagePath = vich_uploader_asset(category, 'thumbnailFile') %}
            {% if imagePath %}
              <img src="{{ imagePath | imagine_filter('thumb_700x_auto') }}" alt="{{ category.name }}">
            {% else %}
              <img src="{{ asset('images/default-recipe.webp') }}" alt="Image par défaut">
            {% endif %}
            <div class="category-card-body text-center">
              <h5>{{ category.name }}</h5>
              <p>{{ category.description|default('Description non disponible') }}</p>
              <a href="{{ path('recipes_by_category', { slug: category.slug }) }}" class="btn">Voir les recettes</a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</section>

  <!-- Appel à contribution -->
  <section class="contribution-section py-5 fade-in-section" style="background: linear-gradient(135deg, #eaf5eb 0%, #d0e3ce 100%);">
    <div class="container text-center">
      <h2 class="mb-4 fw-bold" style="font-family: 'Playfair Display', serif; font-size: 2.3rem;">Contribution</h2>
      <h3 style="color: #4a7c59;">Partagez votre propre recette !</h3>
      <p class="mb-4" style="font-size: 1.2rem; color: #3e5c4e;">
        Vous avez une idée gourmande à faire découvrir ? Rejoignez notre communauté de passionnés et inspirez les autres !
      </p>
      <a class="btn btn-primary btn-lg btn-contribution" href="{{ path('recipe_new')}}">
        <i class="fas fa-utensils me-2"></i> Envoyer ma recette
      </a>
    </div>
  </section>

  <!-- Témoignages -->
 <section class="testimonials-section py-5 fade-in-section">
  <div class="container">
    <h2 class="text-center mb-4 fw-bold" style="font-family: 'Playfair Display', serif; font-size: 2.3rem;">
      Témoignages
    </h2>
    <h3 class="text-center mb-4" style="color: #4a7c59;">Ils ont partagé leurs recettes</h3>

    <div id="testimonialCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="8000">
      <div class="carousel-inner">

        {% for testimonial in testimonials %}
          <div class="carousel-item {% if loop.first %}active{% endif %}">
            <div class="card mx-auto" style="max-width: 700px; border-radius: 1.5rem; box-shadow: 0 10px 28px rgba(46, 77, 46, 0.15); padding: 2rem; background: #fff;">
              
              <!-- Étoiles -->
              <div class="d-flex justify-content-center mb-3 star-rating" style="color: #4caf50; font-size: 1.4rem;">
                {% for i in 1..5 %}
                  {% if i <= testimonial.rating %}
                    <i class="fas fa-star"></i>
                  {% else %}
                    <i class="far fa-star"></i>
                  {% endif %}
                {% endfor %}
              </div>

              <!-- Contenu du témoignage -->
              <blockquote class="blockquote text-center" style="font-style: italic; color: #2e4d2e; font-size: 1.3rem;">
                <p>“{{ testimonial.text }}”</p>
              </blockquote>

              <!-- Auteur (nom d'utilisateur dynamique) -->
              <footer class="blockquote-footer text-center mt-3" style="color: #4a7c4a; font-weight: 600;">
                {{ testimonial.user.username|title }}
              </footer>

            </div>
          </div>
        {% else %}
          <div class="text-center text-muted py-5">
            Aucun témoignage pour le moment.
          </div>
        {% endfor %}

      </div>

      <button class="carousel-control-prev" type="button" data-bs-target="#testimonialCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true" style="background-color: rgba(56, 142, 60, 0.8); border-radius: 50%; width: 40px; height: 40px;"></span>
        <span class="visually-hidden">Précédent</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#testimonialCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true" style="background-color: rgba(56, 142, 60, 0.8); border-radius: 50%; width: 40px; height: 40px;"></span>
        <span class="visually-hidden">Suivant</span>
      </button>
    </div>

    <div class="text-center mt-4">
      <a href="{{ path('testimonial_new') }}" class="btn btn-success btn-contribution" style="font-weight: 700; border-radius: 50px; padding: 12px 30px;">
        <i class="fas fa-plus me-2"></i> Ajouter un avis
      </a>
    </div>
  </div>
</section>


  <!-- Statistiques -->
  <section class="stats-section py-5 text-white fade-in-section" style="background-color: #4a7c59;">
    <div class="container">
      <h2 class="text-center mb-4 fw-bold" style="font-family: 'Playfair Display', serif; font-size: 2.3rem;">Statistiques</h2>
      <h3 class="text-center mb-4" style="color: #e2f2e2;">Une communauté qui grandit chaque jour</h3>
      <div class="row text-center">

        <div class="col-md-4 mb-4">
          <div class="stat-number fs-1 fw-bold" data-count="1200">0</div>
          <p class="fs-5">Recettes partagées</p>
        </div>

        <div class="col-md-4 mb-4">
          <div class="stat-number fs-1 fw-bold" data-count="350">0</div>
          <p class="fs-5">Contributeurs actifs</p>
        </div>

        <div class="col-md-4 mb-4">
          <div class="stat-number fs-1 fw-bold" data-count="98">0</div>
          <p class="fs-5">% de satisfaction</p>
        </div>

      </div>
    </div>
  </section>
{% endblock %}
